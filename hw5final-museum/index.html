<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">

    <title>Harmonic Collection</title>
      <body>
        <div class="sidebar">

    <p class="intro">
    when i was little, <br><br>
    i'd always see my older brother<br>
    playing on the xbox<br><br>
    and no matter how much older i became,<br>
    the memory still sticks to<br>
    the back of my head. . .
    </p>

    <main>
        <a href="./pages/1/KH.html" class="button"><span>KINGDOM HEARTS</span></a>
          
        <a href="./pages/2/JSR.html" class="button2"><span>JET SET RADIO</span></a>

        <a href="./pages/3/ff.html" class="button3"><span>FINAL FANTASY</span></a>

       <a href="./pages/4/h.html" class="button4"><span>HALO</span></a>

<div class="module1">


  </div>
</div> <script type="text/javascript" src="lib/jquery-3.7.1.min.js"></script>
</head>

  <div class="sphere-stage" id="stage">
    <div class="sphere-viewport" id="viewport"></div>
  </div>
</div>

<script>

const TEXT = "xbox ";

const POINT_COUNT = 700;
const RADIUS = 250;
const FOV = 850;
const viewport = document.getElementById('viewport');
const stage = document.getElementById('stage');


let width = stage.clientWidth;
let height = stage.clientHeight;
let cx = width/2, cy = height/2;

const chars = Array.from(TEXT);
const charLen = chars.length;


const points = [];
for (let i = 0; i < POINT_COUNT; i++) {
  const t = i / (POINT_COUNT - 1);
  const phi = Math.acos(1 - 2*t);
  const theta = Math.PI * (1 + Math.sqrt(5)) * i;

  const x = Math.sin(phi) * Math.cos(theta);
  const y = Math.cos(phi);
  const z = Math.sin(phi) * Math.sin(theta);

  points.push({
    baseX: x, baseY: y, baseZ: z,
    el: null
  });
}


points.forEach((pt, i) => {
  const el = document.createElement("div");
  el.className = "point";
  el.textContent = chars[i % charLen];
  el.style.fontSize = (18 + Math.random()*4) + "px";
  viewport.appendChild(el);
  pt.el = el;
});


let rotX = -0.2;
let rotY = 0;
let dragging = false;
let lastPointer = {x:0, y:0};
let velocity = {x:0, y:0};


let inertia = {vx:0, vy:0}; 

function onPointerDown(e){
  dragging = true;
  lastPointer.x = e.clientX;
  lastPointer.y = e.clientY;
  inertia.vx = 0;
  inertia.vy = 0;
}

function onPointerMove(e){
  if(!dragging) return;
  const dx = e.clientX - lastPointer.x;
  const dy = e.clientY - lastPointer.y;

  const sens = 0.006;
  rotY += dx * sens;
  rotX += dy * sens;

  rotX = Math.max(-Math.PI/2 + 0.2, Math.min(Math.PI/2 - 0.2, rotX));

  velocity.x = dx;
  velocity.y = dy;

  lastPointer.x = e.clientX;
  lastPointer.y = e.clientY;
}

function onPointerUp(){
  dragging = false;

  inertia.vx = velocity.x * 0.02;
  inertia.vy = velocity.y * 0.02;
}

stage.addEventListener('pointerdown', onPointerDown);
window.addEventListener('pointermove', onPointerMove);
window.addEventListener('pointerup', onPointerUp);

function render(){

  if(!dragging){
    rotY += inertia.vx;
    rotX += inertia.vy;
    inertia.vx *= 0.93;
    inertia.vy *= 0.93;
  }

  const sinX = Math.sin(rotX), cosX = Math.cos(rotX);
  const sinY = Math.sin(rotY), cosY = Math.cos(rotY);

  const rect = viewport.getBoundingClientRect();
  width = rect.width;
  height = rect.height;
  cx = width/2;
  cy = height/2;

  points.forEach(p => {
    let x = p.baseX * RADIUS;
    let y = p.baseY * RADIUS;
    let z = p.baseZ * RADIUS;


    let ry = y * cosX - z * sinX;
    let rz = y * sinX + z * cosX;


    let rx = x * cosY + rz * sinY;
    let rz2 = -x * sinY + rz * cosY;

    const perspective = FOV / (FOV + rz2);
    const sx = rx * perspective;
    const sy = ry * perspective;

    const px = cx + sx;
    const py = cy + sy;

    const depth = (rz2 + RADIUS) / (2 * RADIUS);
    const scale = 0.4 + depth * 1.1;
    const opacity = 0.25 + depth * 0.95;

    const el = p.el;
    el.style.transform = `translate(${px - 10}px, ${py - 10}px) scale(${scale})`;
    el.style.opacity = opacity;
    el.style.zIndex = Math.round(depth * 1000);
  });

  requestAnimationFrame(render);
}

render();
</script>

</body>
</html>

  